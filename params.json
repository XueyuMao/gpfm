{"name":"Gaussian Process Factorization Machines ","tagline":"Code for the paper \"Gaussian Process Factorization Machines  for Context-aware Recommendations\"","body":"gpfm\r\n====\r\n\r\nThis is the documentation of the code for the Gaussian process factorization machines (GPFMs) used in our SIGIR'2014 paper entitled \"Gaussian Process Factorization Machines  for Context-aware Recommendations\". \r\n\r\nFor questions, please contact trung(dot)ngvan(at)gmail(dot)com.\r\n\r\nLast update: 10/05/2014.\r\n\r\n## INPUT FORMAT\r\n\r\nGPFM can deal with two types of feedback: explicit and implicit. The code requires that you provide the training and testing data in the format required by GPFM (for explicit feedback) and GPPW (for implicit feedback). This should be given in the form of observation matrices.\r\n\r\n### 1.1 Explicit feedback\r\nIt is most convenient to introduce the observation matrix with an example:\r\n\r\n1 2 1 1 4\r\n\r\n1 1 2 1 3\r\n\r\n1 1 1 2 1\r\n\r\n2 1 2 2 5\r\n\r\n2 1 3 1 1\r\n\r\nHere we have 5 observations each represented in one row of the matrix. When storing in a file, the equivalent is one line of the file.\r\n\r\nEach row/observation contains the following attributes:\r\n\r\nuser_id, item_id, context_variable_1, context_variable_2, ..., context_variable_K, rating.\r\n\r\nConsider the 3rd observation, the user_id is 1, item_id is 1, and it has two contextual variables. The first contextual variable has value 1 and the second has value 2. The rating given to this combination of item and context (1,1,2) is 1 by the user.\r\n\r\nSome important issues to remember:\r\n- Currently only categorical attributes are supported. Thus, all elements of the matrix must be integer (except the ratings which can be real-valued).\r\n- In MATLAB, subscript/index starts from 1 so if your data has 0, you must convert that to 1 e.g. increase the value of all of your categorical features.\r\n\r\nSee _data/demo_train.csv_ and _data/demo_test.csv_. Of course, the format is the same for both of the training and testing data.\r\n\r\n### 1.2 Implicit feedback\r\n\r\nFor the case of implicit feedback, an additional pairwise comparison matrix is required for pairwise preference training.\r\nIf we were to convert the above dataset into implicit feedback with rating higher than 3 as relevant items, the following 2 matrices are needed for GPPW.\r\n\r\n**Item-based matrix:**\r\n\r\n1 2 1 1 +1\r\n\r\n1 1 2 1 -1\r\n\r\n1 1 1 2 -1\r\n\r\n2 1 2 2 +1\r\n\r\n2 1 3 1 -1\r\n\r\nNote that this matrix is in exactly the same format as in the explicit feedback case, except that now the ratings are +1 (relevant) and -1 (irrelevant) only. Likewise, the test matrix can be of the same format as well.\r\n\r\n**Pairwise matrix:**\r\n\r\n1 2 1 1 1 2 1 +1\r\n\r\n1 2 1 1 1 1 2 +1\r\n\r\n1 1 2 1 2 1 1 -1\r\n\r\n1 1 1 2 2 1 1 -1\r\n\r\n2 1 2 2 1 3 1 +1\r\n\r\n2 1 3 1 1 2 2 -1\r\n\r\nEach row in the pairwise matrix has the form:\r\n\r\nuser_id, (item_id1, contexts1), (item_id2, contexts2), preference\r\n\r\nwhere preference = +1 if user prefers the first combination (item_id1, contexts1) over the second combination (item_id2, contexts2).\r\n\r\nLet us consider user 1 as an example. He likes the (item,context) combination of (2,1,1) and dislikes the combination of (1,2,1) so we create the pairwise preference in the first row: 1 2 1 1 1 2 1 +1\r\n\r\nSee _data/demo_pw_train.csv_ for an example of pairwise matrix; _data/demo_pw_item.csv_ and _data/demo_pw_test.csv_ are similar to that in the explicit case.\r\n\r\n## TRAINING AND MAKING PREDICTION\r\n\r\nOnce the data is in the right format, it is straightforward to run GPFM or GPPW on them. \r\n\r\nThere are a few parameters to configure for each specific dataset, but the recommended / default values can be found in the demo script. \r\nThe most important ones are:\r\n- **kernel** : which kernel to use (one of 'rbf', 'linearOne', or 'linear'), but 'rbf' is most powerful and often outperforms the other two kernels\r\n- **useBias** : whether to use the bias term in the model\r\n- **learnRate** : learning rate of the stochastic gradient descent algorithm (this should be set according to the datasets)\r\n- **dimItem** : the latent dimension of items\r\n- **dimContext** : the latent dimensions of contexts \r\n\r\nSee _scripts/demo_gpfm.m_ and _scripts/demo_gppw.m_ for an example of how to set-up and run a GPFM model on an explicit feedback problem and a GPPW model on an implicit feedback problem. \r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}